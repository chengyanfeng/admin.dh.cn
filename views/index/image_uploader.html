<div id="pad-wrapper" class="form-page">
    <div class="row-fluid form-wrapper">
        <div class="span12 column">
            <form operation="do_image_upload" object="index" enctype="multipart/form-data">
                <div class="field-box">
                    <label>图片：</label>
                    <input name="file" id="file" class="span3 inline-input" type="file" value="" onchange="file_change(this.id)" required/>
                    <br/>
                    <br/>
                    <img id="file_preview" class="thrumb_preview" src="{$static_root}img/no-img-gallery.png" style="height: 100px;width: auto"/>
                </div>
                <div class="field-box">
                    <input type="hidden" id="bind_input" value="{$input}">
                    <input type="hidden" id="bind_view" value="{$view}">
                    <input type="submit" class="btn-flat default" value="提 交">
                    <input type="button" class="btn-flat gray" action="cancel" value="取 消">
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    function file_change(sourceId){
        $("#file_preview").attr("src",getFileUrl(sourceId))
    }

    function getFileUrl(sourceId) {
        var url;
        if (navigator.userAgent.indexOf("MSIE")>=1) { // IE
            url = document.getElementById(sourceId).value;
        } else if(navigator.userAgent.indexOf("Firefox")>0) { // Firefox
            url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
        } else if(navigator.userAgent.indexOf("Chrome")>0) { // Chrome
            url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
        }
        return url;
    }
</script>